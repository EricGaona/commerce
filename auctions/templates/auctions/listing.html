{% extends "auctions/layout.html" %} 
{% block title %}{{ listing.title }}{% endblock %}   


{% block body %}

<div class="container">
    <h2>{{ listing.title }}</h2>
    <img src="{{ listing.image_url|default_if_none:'#' }}" class="img-fluid mb-3" alt="Image for {{ listing.title }}" />
    <p>{{ listing.description }}</p>
    <p><strong>Starting Bid: ${{ listing.starting_bid }}</strong></p>
  
    {% if user.is_authenticated %}
      <form action="{% url 'listing_page' listing.id %}" method="post" class="mb-3">
        {% csrf_token %}
        <div class="form-group">
          <input type="number" name="amount" class="form-control" placeholder="Enter your bid" required />
        </div>
        <button type="submit" name="place_bid" class="btn btn-primary">Place Bid</button>
      </form>
      {% if in_watchlist %}
        <form action="{% url 'remove_watchlist' listing.id %}" method="post" class="mb-3">
          {% csrf_token %}
          <button type="submit" class="btn btn-danger">Remove from Watchlist</button>
        </form>
      {% else %}
        <form action="{% url 'add_watchlist' listing.id %}" method="post" class="mb-3">
          {% csrf_token %}
          <button type="submit" class="btn btn-success">Add to Watchlist</button>
        </form>
      {% endif %}
    {% endif %}
  
    <h3>Comments</h3>
    <ul class="list-group mb-3">
      {% for comment in comments %}
        <li class="list-group-item"><strong>{{ comment.user.username }}:</strong> {{ comment.content }}</li>
      {% empty %}
        <p>No comments yet.</p>
      {% endfor %}
    </ul>
  
    {% if user.is_authenticated %}
      <form action="{% url 'listing_page' listing.id %}" method="post">
        {% csrf_token %}
        <div class="form-group">
          <textarea name="content" class="form-control" placeholder="Add a comment" required></textarea>
        </div>
        <button type="submit" name="add_comment" class="btn btn-secondary">Comment</button>
      </form>
    {% endif %}
  </div>
{% endblock %}
